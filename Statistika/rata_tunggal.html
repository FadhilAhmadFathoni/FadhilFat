<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hitung Rata-Rata dengan Grafik</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Mengatur font default */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }

        /* Wrapper utama untuk konten */
        .container {
            width: 90%;
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
        }

        h1 {
            text-align: center;
            color: #007BFF;
            font-size: 2em;
        }

        /* Form dan input */
        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 2px solid #007BFF;
            border-radius: 5px;
            font-size: 1rem;
            outline: none;
            box-sizing: border-box;
        }

        input[type="text"]:focus {
            border-color: #0056b3;
        }

        button {
            width: 100%;
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
            margin: 5px 0;
            box-sizing: border-box;
        }

        button:hover {
            background-color: #0056b3;
        }

        button:active {
            background-color: #004085;
        }

        /* Styling untuk snackbar */
        #snackbar {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 2px;
            padding: 16px;
            position: fixed;
            z-index: 1;
            left: 50%;
            bottom: 30px;
            font-size: 17px;
        }
        #snackbar.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }
        @keyframes fadein {
            from {bottom: 0; opacity: 0;}
            to {bottom: 30px; opacity: 1;}
        }
        @keyframes fadeout {
            from {bottom: 30px; opacity: 1;}
            to {bottom: 0; opacity: 0;}
        }

        /* Styling grafik */
        canvas {
            width: 100%;
            height: 300px;
            max-width: 800px;
            margin-top: 20px;
        }

        /* Styling Riwayat */
        #riwayat {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        #riwayat ul {
            list-style: none;
            padding: 0;
        }
        #riwayat li {
            margin-bottom: 10px;
        }

        /* Responsif */
        @media (max-width: 768px) {
            .container {
                width: 95%;
                padding: 10px;
            }
            input[type="text"], button {
                width: 100%;
                font-size: 1rem;
            }
            h1 {
                font-size: 1.5em;
            }
            canvas {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hitung Rata-Rata Tunggal</h1>
        <p>Masukkan angka-angka yang dipisahkan dengan koma (,):</p>
        <input type="text" id="angka" placeholder="Contoh: 10, 20, 30, 40, 50">
        <button onclick="hitungRataRata()">Hitung Rata-Rata</button>
        <button onclick="resetInput()">Reset</button>

        <pre id="penjelasan"></pre>
        <p id="hasil"></p>

        <canvas id="grafik"></canvas>

        <!-- Snackbar untuk pemberitahuan -->
        <div id="snackbar">Input berhasil!</div>

        <!-- Riwayat Perhitungan -->
        <div id="riwayat">
            <h3>Riwayat Perhitungan</h3>
            <ul id="riwayatList"></ul>
            <button onclick="clearHistory()">Hapus Riwayat</button>
        </div>
    </div>

    <script>
        let chartInstance; // Menyimpan referensi grafik
        let history = []; // Array untuk menyimpan riwayat perhitungan

        function hitungRataRata() {
            let inputAngka = document.getElementById('angka').value;
            let angkaArray = inputAngka.split(',').map(Number);

            // Validasi input
            if (angkaArray.some(isNaN)) {
                showSnackbar('Pastikan semua input adalah angka dan dipisahkan dengan koma!');
                return;
            }

            let jumlah = 0;
            let totalAngka = angkaArray.length;

            // Menjumlahkan angka-angka
            for (let i = 0; i < totalAngka; i++) {
                jumlah += angkaArray[i];
            }

            // Menghitung rata-rata
            let rataRata = jumlah / totalAngka;

            // Menampilkan hasil
            document.getElementById('hasil').innerText = `Rata-rata: ${rataRata.toFixed(2)}`;
            tampilkanCaraPerhitungan(angkaArray, totalAngka, jumlah); // Menampilkan cara perhitungan
            tampilkanGrafik(angkaArray); // Menampilkan grafik

            // Simpan hasil perhitungan ke riwayat
            saveHistory(inputAngka, rataRata.toFixed(2));

            // Menampilkan snackbar sukses
            showSnackbar('Input berhasil!');
        }

        function showSnackbar(message) {
            let snackbar = document.getElementById('snackbar');
            snackbar.innerText = message;
            snackbar.className = 'show';
            setTimeout(function() {
                snackbar.className = snackbar.className.replace('show', '');
            }, 3000);
        }

        function tampilkanCaraPerhitungan(angkaArray, totalAngka, jumlah) {
            let caraPerhitungan = `
${angkaArray.join(' + ')}
----------------------  = ${jumlah / totalAngka.toFixed(2)}
            ${totalAngka}
            `;
            document.getElementById('penjelasan').innerText = caraPerhitungan;
        }

        function tampilkanGrafik(data) {
            // Menghitung frekuensi setiap angka
            let frekuensi = {};
            data.forEach(function(num) {
                frekuensi[num] = (frekuensi[num] || 0) + 1;
            });

            // Mendapatkan angka yang unik dan frekuensinya
            let angkaUnik = Object.keys(frekuensi);
            let frekuensiAngka = Object.values(frekuensi);

            const ctx = document.getElementById('grafik').getContext('2d');

            // Jika ada grafik yang sudah ada, hancurkan grafik sebelumnya
            if (chartInstance) {
                chartInstance.destroy();
            }

            // Membuat grafik baru
            chartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: angkaUnik,  // Angka yang unik di sumbu X
                    datasets: [{
                        label: 'Frekuensi',
                        data: frekuensiAngka, // Jumlah kemunculan di sumbu Y
                        backgroundColor: 'rgba(75, 192, 192, 0.5)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(tooltipItem) {
                                    return tooltipItem.label + ': ' + tooltipItem.raw + ' kali'; // Menampilkan frekuensi saat hover
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function resetInput() {
            document.getElementById('angka').value = '';
            document.getElementById('hasil').innerText = '';
            document.getElementById('penjelasan').innerText = '';
            let ctx = document.getElementById('grafik').getContext('2d');
            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height); // Menghapus grafik
            // Menghapus snackbar
            showSnackbar('Input direset');
        }

        function saveHistory(input, result) {
            const historyItem = {
                input: input,
                result: result
            };
            history.push(historyItem);
            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            const riwayatList = document.getElementById('riwayatList');
            riwayatList.innerHTML = ''; // Menghapus isi sebelumnya
            history.forEach((item, index) => {
                const listItem = document.createElement('li');
                listItem.innerHTML = `Angka: ${item.input} => Rata-rata: ${item.result}`;
                riwayatList.appendChild(listItem);
            });
        }

        function clearHistory() {
            history = [];
            updateHistoryDisplay();
        }
    </script>
</body>
</html>
